<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>深度解读GMX：去中心化永续合约交易所 | Xuqi.Zhong的博客</title><meta name=keywords content><meta name=description content="0 GMX项目发展史 在2020年10月，xvi10启动了 xvix-contracts 项目，并部署到了Ethereum Mainnet。 在2021年3月，xvi10把 xvix-contracts 升级为 gambit-contracts ，并部署到了BSC。 在2021年9月，xvi10基于 gambit-contracts 启动GMX项目，并部署到了Arbitrum One。 在启动一周后，GMX完成了第一次升级，在eth、wbtc和usdc的基础上，添加了link、uni和usdt。 在启动三个月后，GMX，完成了第二次升级，部署到了Avalanche链上。
1 GMX的产品设计目标 GMX的产品设计目标是打造一个去中心化的永续合约和现货交易平台。不需要任何注册、KYC和地域限制等限制，用户即可方便地用它进行链上资产交易和合约交易。
2 GMX的核心卖点  去中心化。GMX是一个去中心化的永续合约交易平台，所有资产由智能合约保管，智能合约开源，所有运营数据也是公开透明的。 全额保证金。GMX上面的所有杠杆订单都是有全额保证金的，保障用户的收益能够钢性对付，很多中心化交易所都无法做到全额保证金。 无需许可Permissionless。所有人都可以公平得参与平台做市，并且根据GMX和GLP持有量平等地分到平台的盈利。 市场报价去中心化。系统报价主要由ChainLink和报价机器人组成，报价公开透明，有效避免了恶意插针等扰乱市场的行为。  3 GMX的系统整体设计 3.1 GMX系统架构图 其中，Vault合约是整个GMX的核心，负责管理GMX平台的全部资产。
3.2 系统核心数据模型 { 	&#34;id&#34;: keccak256(_account, _collateralToken, _indexToken, _isLong), // 仓位ID 	&#34;size&#34;: uint256, // Position大小 	&#34;collateral&#34;: uint256, // 抵押品价格 USD 	&#34;averagePrice&#34;: uint256, // 平均持仓价格 USD 	&#34;entryFundingRate&#34;: uint256, // 入场资金费率 	&#34;reserveAmount&#34;: uint256, // 抵押品token储备数量 	&#34;realisedPnl&#34;: int256, // 已兑付盈亏 	&#34;lastIncreasedTime&#34;: uint256, // 最后加仓时间 } 盈亏USD价值计算："><meta name=author content="Xuqi.Zhong"><link rel=canonical href=https://zhongxuqi.github.io/web3/2023-02-27/><meta name=google-site-verification content="XYZabc"><meta name=yandex-verification content="XYZabc"><meta name=msvalidate.01 content="XYZabc"><link crossorigin=anonymous href=/assets/css/stylesheet.3613efbd0b1772781e8f49935e973cae632a7f61471c05b17be155505ccf87b5.css integrity="sha256-NhPvvQsXcngej0mTXpc8rmMqf2FHHAWxe+FVUFzPh7U=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.f413e19d0714851f6474e7ee9632408e58ac146fbdbe62747134bea2fa3415e0.js integrity="sha256-9BPhnQcUhR9kdOfuljJAjlisFG+9vmJ0cTS+ovo0FeA=" onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=https://zhongxuqi.github.io/%3Clink%20/%20abs%20url%3E><link rel=icon type=image/png sizes=16x16 href=https://zhongxuqi.github.io/%3Clink%20/%20abs%20url%3E><link rel=icon type=image/png sizes=32x32 href=https://zhongxuqi.github.io/%3Clink%20/%20abs%20url%3E><link rel=apple-touch-icon href=https://zhongxuqi.github.io/%3Clink%20/%20abs%20url%3E><link rel=mask-icon href=https://zhongxuqi.github.io/%3Clink%20/%20abs%20url%3E><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><noscript><style>#theme-toggle,.top-link{display:none}</style></noscript><meta property="og:title" content="深度解读GMX：去中心化永续合约交易所"><meta property="og:description" content="0 GMX项目发展史 在2020年10月，xvi10启动了 xvix-contracts 项目，并部署到了Ethereum Mainnet。 在2021年3月，xvi10把 xvix-contracts 升级为 gambit-contracts ，并部署到了BSC。 在2021年9月，xvi10基于 gambit-contracts 启动GMX项目，并部署到了Arbitrum One。 在启动一周后，GMX完成了第一次升级，在eth、wbtc和usdc的基础上，添加了link、uni和usdt。 在启动三个月后，GMX，完成了第二次升级，部署到了Avalanche链上。
1 GMX的产品设计目标 GMX的产品设计目标是打造一个去中心化的永续合约和现货交易平台。不需要任何注册、KYC和地域限制等限制，用户即可方便地用它进行链上资产交易和合约交易。
2 GMX的核心卖点  去中心化。GMX是一个去中心化的永续合约交易平台，所有资产由智能合约保管，智能合约开源，所有运营数据也是公开透明的。 全额保证金。GMX上面的所有杠杆订单都是有全额保证金的，保障用户的收益能够钢性对付，很多中心化交易所都无法做到全额保证金。 无需许可Permissionless。所有人都可以公平得参与平台做市，并且根据GMX和GLP持有量平等地分到平台的盈利。 市场报价去中心化。系统报价主要由ChainLink和报价机器人组成，报价公开透明，有效避免了恶意插针等扰乱市场的行为。  3 GMX的系统整体设计 3.1 GMX系统架构图 其中，Vault合约是整个GMX的核心，负责管理GMX平台的全部资产。
3.2 系统核心数据模型 { 	&#34;id&#34;: keccak256(_account, _collateralToken, _indexToken, _isLong), // 仓位ID 	&#34;size&#34;: uint256, // Position大小 	&#34;collateral&#34;: uint256, // 抵押品价格 USD 	&#34;averagePrice&#34;: uint256, // 平均持仓价格 USD 	&#34;entryFundingRate&#34;: uint256, // 入场资金费率 	&#34;reserveAmount&#34;: uint256, // 抵押品token储备数量 	&#34;realisedPnl&#34;: int256, // 已兑付盈亏 	&#34;lastIncreasedTime&#34;: uint256, // 最后加仓时间 } 盈亏USD价值计算："><meta property="og:type" content="article"><meta property="og:url" content="https://zhongxuqi.github.io/web3/2023-02-27/"><meta property="og:image" content="https://opensea.io/zh-CN/assets/ethereum/0xaf6434ff6a3a1fe62473dfacccda043caff6793c/2890"><meta property="article:section" content="web3"><meta property="article:published_time" content="2023-02-27T21:57:17+08:00"><meta property="article:modified_time" content="2023-02-27T21:57:17+08:00"><meta property="og:site_name" content="Xuqi.Zhong的博客"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://opensea.io/zh-CN/assets/ethereum/0xaf6434ff6a3a1fe62473dfacccda043caff6793c/2890"><meta name=twitter:title content="深度解读GMX：去中心化永续合约交易所"><meta name=twitter:description content="0 GMX项目发展史 在2020年10月，xvi10启动了 xvix-contracts 项目，并部署到了Ethereum Mainnet。 在2021年3月，xvi10把 xvix-contracts 升级为 gambit-contracts ，并部署到了BSC。 在2021年9月，xvi10基于 gambit-contracts 启动GMX项目，并部署到了Arbitrum One。 在启动一周后，GMX完成了第一次升级，在eth、wbtc和usdc的基础上，添加了link、uni和usdt。 在启动三个月后，GMX，完成了第二次升级，部署到了Avalanche链上。
1 GMX的产品设计目标 GMX的产品设计目标是打造一个去中心化的永续合约和现货交易平台。不需要任何注册、KYC和地域限制等限制，用户即可方便地用它进行链上资产交易和合约交易。
2 GMX的核心卖点  去中心化。GMX是一个去中心化的永续合约交易平台，所有资产由智能合约保管，智能合约开源，所有运营数据也是公开透明的。 全额保证金。GMX上面的所有杠杆订单都是有全额保证金的，保障用户的收益能够钢性对付，很多中心化交易所都无法做到全额保证金。 无需许可Permissionless。所有人都可以公平得参与平台做市，并且根据GMX和GLP持有量平等地分到平台的盈利。 市场报价去中心化。系统报价主要由ChainLink和报价机器人组成，报价公开透明，有效避免了恶意插针等扰乱市场的行为。  3 GMX的系统整体设计 3.1 GMX系统架构图 其中，Vault合约是整个GMX的核心，负责管理GMX平台的全部资产。
3.2 系统核心数据模型 { 	&#34;id&#34;: keccak256(_account, _collateralToken, _indexToken, _isLong), // 仓位ID 	&#34;size&#34;: uint256, // Position大小 	&#34;collateral&#34;: uint256, // 抵押品价格 USD 	&#34;averagePrice&#34;: uint256, // 平均持仓价格 USD 	&#34;entryFundingRate&#34;: uint256, // 入场资金费率 	&#34;reserveAmount&#34;: uint256, // 抵押品token储备数量 	&#34;realisedPnl&#34;: int256, // 已兑付盈亏 	&#34;lastIncreasedTime&#34;: uint256, // 最后加仓时间 } 盈亏USD价值计算："><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Web3s","item":"https://zhongxuqi.github.io/web3/"},{"@type":"ListItem","position":2,"name":"深度解读GMX：去中心化永续合约交易所","item":"https://zhongxuqi.github.io/web3/2023-02-27/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"深度解读GMX：去中心化永续合约交易所","name":"深度解读GMX：去中心化永续合约交易所","description":"0 GMX项目发展史 在2020年10月，xvi10启动了 xvix-contracts 项目，并部署到了Ethereum Mainnet。 在2021年3月，xvi10把 xvix-contracts 升级为 gambit-contracts ，并部署到了BSC。 在2021年9月，xvi10基于 gambit-contracts 启动GMX项目，并部署到了Arbitrum One。 在启动一周后，GMX完成了第一次升级，在eth、wbtc和usdc的基础上，添加了link、uni和usdt。 在启动三个月后，GMX，完成了第二次升级，部署到了Avalanche链上。\n1 GMX的产品设计目标 GMX的产品设计目标是打造一个去中心化的永续合约和现货交易平台。不需要任何注册、KYC和地域限制等限制，用户即可方便地用它进行链上资产交易和合约交易。\n2 GMX的核心卖点  去中心化。GMX是一个去中心化的永续合约交易平台，所有资产由智能合约保管，智能合约开源，所有运营数据也是公开透明的。 全额保证金。GMX上面的所有杠杆订单都是有全额保证金的，保障用户的收益能够钢性对付，很多中心化交易所都无法做到全额保证金。 无需许可Permissionless。所有人都可以公平得参与平台做市，并且根据GMX和GLP持有量平等地分到平台的盈利。 市场报价去中心化。系统报价主要由ChainLink和报价机器人组成，报价公开透明，有效避免了恶意插针等扰乱市场的行为。  3 GMX的系统整体设计 3.1 GMX系统架构图 其中，Vault合约是整个GMX的核心，负责管理GMX平台的全部资产。\n3.2 系统核心数据模型 { \t\u0026#34;id\u0026#34;: keccak256(_account, _collateralToken, _indexToken, _isLong), // 仓位ID \t\u0026#34;size\u0026#34;: uint256, // Position大小 \t\u0026#34;collateral\u0026#34;: uint256, // 抵押品价格 USD \t\u0026#34;averagePrice\u0026#34;: uint256, // 平均持仓价格 USD \t\u0026#34;entryFundingRate\u0026#34;: uint256, // 入场资金费率 \t\u0026#34;reserveAmount\u0026#34;: uint256, // 抵押品token储备数量 \t\u0026#34;realisedPnl\u0026#34;: int256, // 已兑付盈亏 \t\u0026#34;lastIncreasedTime\u0026#34;: uint256, // 最后加仓时间 } 盈亏USD价值计算：","keywords":[],"articleBody":"0 GMX项目发展史 在2020年10月，xvi10启动了 xvix-contracts 项目，并部署到了Ethereum Mainnet。 在2021年3月，xvi10把 xvix-contracts 升级为 gambit-contracts ，并部署到了BSC。 在2021年9月，xvi10基于 gambit-contracts 启动GMX项目，并部署到了Arbitrum One。 在启动一周后，GMX完成了第一次升级，在eth、wbtc和usdc的基础上，添加了link、uni和usdt。 在启动三个月后，GMX，完成了第二次升级，部署到了Avalanche链上。\n1 GMX的产品设计目标 GMX的产品设计目标是打造一个去中心化的永续合约和现货交易平台。不需要任何注册、KYC和地域限制等限制，用户即可方便地用它进行链上资产交易和合约交易。\n2 GMX的核心卖点  去中心化。GMX是一个去中心化的永续合约交易平台，所有资产由智能合约保管，智能合约开源，所有运营数据也是公开透明的。 全额保证金。GMX上面的所有杠杆订单都是有全额保证金的，保障用户的收益能够钢性对付，很多中心化交易所都无法做到全额保证金。 无需许可Permissionless。所有人都可以公平得参与平台做市，并且根据GMX和GLP持有量平等地分到平台的盈利。 市场报价去中心化。系统报价主要由ChainLink和报价机器人组成，报价公开透明，有效避免了恶意插针等扰乱市场的行为。  3 GMX的系统整体设计 3.1 GMX系统架构图 其中，Vault合约是整个GMX的核心，负责管理GMX平台的全部资产。\n3.2 系统核心数据模型 { \t\"id\": keccak256(_account, _collateralToken, _indexToken, _isLong), // 仓位ID \t\"size\": uint256, // Position大小 \t\"collateral\": uint256, // 抵押品价格 USD \t\"averagePrice\": uint256, // 平均持仓价格 USD \t\"entryFundingRate\": uint256, // 入场资金费率 \t\"reserveAmount\": uint256, // 抵押品token储备数量 \t\"realisedPnl\": int256, // 已兑付盈亏 \t\"lastIncreasedTime\": uint256, // 最后加仓时间 } 盈亏USD价值计算：\ndelta = position.size * (currentPrice - position.averagePrice) / position.averagePrice 4 GMX核心业务逻辑解读 了解了GMX系统设计框架，那么解析来就逐个解析它的核心业务流程。\n4.1 GMX加减仓业务逻辑 4.1.1 GMX加减仓业务流程 创建订单流程\n 用户在Web页面发起市价或者限价单，并发送Transaction到链上。 Transaction会根据用户的提交参数，选择调用市价单或者限价单合约来创建订单。 结束，等待交易机器人执行交易。  执行订单流程\n 执行交易机器人根据市场价选择执行市价单或者限价单，并发送交易到链上。 Transaction会根据会根据机器人的提交参数，选择调用市价单或者限价单合约和执行订单。 市价单或者限价单合约会调用Vault合约来执行加减仓操作。  4.1.2 GMX加减仓流程解读 从加减仓业务流程中可以看出，订单的创建和执行是2个独立的步骤。首先，用户创建市价单和限价单，并由市价单合约和限价单合约来保存订单数据。然后，订单执行机器人会异步调用市价单合约和限价单合约来执行订单。订单执行机器人可以根据当前的市价选择哪些订单可以被执行。\n手续费 = 交易手续费 + 资金费用\n 交易手续费：价减仓USD金额 * 0.1%。 资金费用：仓位总USD价值 * 时间间隔 * 单位USD单位时间间隔的费率。  爆仓条件 另外还需要判断是否爆仓，满足一下条件之一就有可能爆仓。\n 条件一：抵押品总USD价值 + 仓位盈亏USD价值 条件二：(抵押品总USD价值 + 仓位盈亏USD价值) * 最大杠杆倍数  相关合约地址\n   合约名称 合约地址     市价单合约 0xb87a436b93ffe9d75c5cfa7bacfff96430b09868   限价单合约 0x09f77e8a13de9a35a7231028187e9fd5db8a2acb   Vault合约 0x489ee077994b6658eafa855c308275ead8097c4a    相关交易操作交易Hash\n   操作名称 交易Hash     用户发起市价单加仓交易 0x3230e702a44c6029790d279d0a11e87f89474a9fec251aa0b7f5070aab38104b   用户发起市价单减仓交易 0x7d359cb6a1744f87c6b4cc1ff93a8b8ee9fc6bbfa73227e8c7d8b59214a8a368   执行机器人执行市价单 0x5f5a3a90ed30b099ad456f14e7ea580cea3f25cd4bdf2d491ae5e18eadd87ff2   执行机器人执行限价单 0x3cc5b3bd1fc5efeba0cbf1cfc5752773d9476c15b2fb8cc3bb5dc02b8480b5af    4.2 GMX清算业务逻辑 4.2.1 GMX清算业务流程 清算流程\n 清算机器人发送清算交易，并广播到链上 仓位管理合约调用Vault合约执行清算逻辑  4.2.2 GMX清算流程解读 清算流程主要清算机器人来发起，清算机器人会监控合约中的Position，并调用合约方法来对爆仓的Position进行清算。完成清算任务后，清算机器人收到一笔清算手续费。\n仓位清算条件 满足一下条件之一就可以被清算\n 条件一：抵押品总USD价值 + 仓位盈亏USD价值 条件二：(抵押品总USD价值 + 仓位盈亏USD价值) * 最大杠杆倍数  相关合约地址\n   合约名称 合约地址     仓位管理合约 0x75e42e6f01baf1d6022bea862a28774a9f8a4a0c   Vault合约 0x489ee077994b6658eafa855c308275ead8097c4a    相关交易操作交易Hash\n   操作名称 交易Hash     清算机器人发起清算流程 0xccca7adf093d4e20ed25d2d479419a1efaac964c337beea958f214b4db195c34    4.3 GMX现货交易业务逻辑 4.3.1 GMX现货交易业务流程 现货交易流程\n 用户发起现货交易，并广播到链上。 Router合约调用Vault合约执行现货交易。 Vault合约从Token价格合约获取价格，并执行交易  4.3.2 GMX现货交易流程解读 GMX的现货交易不是主流的AMM，而是通过Chainlink获取TokenIn价格，然后计算出TokenOut的数量。具体计算过程如下\n 先从Token价格合约获取tokenInUSDPrice和tokenOutUSDPrice。 计算tokenOutAmount：tokenOutAmount = tokenInAmount * tokenInUSDPrice / tokenOutUSDPrice。  相关合约地址\n   合约名称 合约地址     Router合约 0xabbc5f99639c9b6bcb58544ddf04efa6802f4064   Vault合约 0x489ee077994b6658eafa855c308275ead8097c4a   Token价格合约 0x2d68011bca022ed0e474264145f46cc4de96a002    相关交易操作交易Hash\n   操作名称 交易Hash     用户发起现货交易 0x0da7809c5f6372b5cc7342493fa405d0215d56ac47167b2682797df3ac4fca64    4.4 GMX质押和解除业务逻辑 4.4.1 GMX质押业务流程 GMX质押流程\n 用户向RewardRouter合约发起GMX质押。 RewardRouter合约调用sGMX RewardTracker合约，质押GMX并得到sGMX。 RewardRouter合约调用sbGMX RewardTracker合约，质押sGMX并得到sbGMX。 RewardRouter合约调用sbfGMX RewardTracker合约，质押sbGMX并得到sbfGMX。 用户最终得到sbfGMX。  4.4.2 GMX质押流程解读 质押业务由用户发起，质押核心业务逻辑在RewardRouter核心实现。质押具体逻辑主要由sGMX RewardTracker合约、sbGMX RewardTracker合约和sbfGMX RewardTracker合约来实现，它们的作用分别为\n sGMX RewardTracker合约是sGMX的ERC20合约，同时负责质押GMX并Mint sGMX。质押GMX的用户可以获取esGMX Token奖励。 sbGMX RewardTracker合约是sbGMX的ERC20合约，同时负责质押sGMX并Mint sbGMX。质押sGMX的用户可以获取bnGMX Token奖励。 sbfGMX RewardTracker合约是sbfGMX的ERC20合约，同时负责质押sbGMX并Mint sbfGMX。质押sbGMX的用户可以获取平台手续费，以WETH结算。 这样做的好处是RewardTracker合约即作为ERC20合约，又负责了质押业务，节省了合约gas成本。  esGMX是什么 esGMX等同与GMX，但是esGMX无法转账交易。用户可以把esGMX质押到gmxVestor合约，一年时间内esGMX就会在一年时间内线性地转换为GMX。\nbnGMX是什么 bnGMX会在restake进行二次质押，并且提升用户的APR。但是在unstake的时候，就会burn掉。\n相关合约地址\n   合约名称 合约地址     RewardRouter合约 0xa906f338cb21815cbc4bc87ace9e68c87ef8d8f1   sGMX RewardTracker合约 0x908c4d94d34924765f1edc22a1dd098397c59dd4   sbGMX RewardTracker合约 0x4d268a7d4c16ceb5a606c173bd974984343fea13   sbfGMX RewardTracker合约 0xd2d1162512f927a7e282ef43a362659e4f2a728f    相关交易操作交易Hash\n   操作名称 交易Hash     GMX质押 0xf885f7691effca2b0ba23423fa38941d3c2341598c6de208f025375e91d3c4e1    4.4.3 GMX解除质押业务流程 GMX解除质押流程\n 用户向RewardRouter合约发起GMX解除质押 RewardRouter合约调用sbfGMX RewardTracker合约，解除质押sbfGMX并得到sbGMX RewardRouter合约调用sbGMX RewardTracker合约，解除质押sbGMX并得到sGMX RewardRouter合约调用sGMX RewardTracker合约，解除质押sGMX并得到GMX 用户最终得到GMX  4.4.4 GMX解除质押流程解读 GMX解除质押业务流程就是质押流程的逆向操作，输入是sbfGMX，最终得到GMX。\n相关合约地址\n   合约名称 合约地址     RewardRouter合约 0xa906f338cb21815cbc4bc87ace9e68c87ef8d8f1   sGMX RewardTracker合约 0x908c4d94d34924765f1edc22a1dd098397c59dd4   sbGMX RewardTracker合约 0x4d268a7d4c16ceb5a606c173bd974984343fea13   sbfGMX RewardTracker合约 0xd2d1162512f927a7e282ef43a362659e4f2a728f    相关交易操作交易Hash\n   操作名称 交易Hash     GMX解除质押 0x1dc5efbc0ddfe09c3596407d1974647b787f77794a415e81df11ff21e8d683c3    4.5 GLP质押和解除业务逻辑 4.5.1 GLP质押业务流程 GLP质押流程\n 用户调用RewardRouter合约，发起GLP Mint和质押流程。 RewardRouter合约调用GlpManager合约，发起GLP Mint。 GlpManager合约调用Vault合约，消耗eth并mint 相应数量的USDg。 GlpManager合约调用GLP合约，消耗USDg并Mint GLP。 RewardRouter合约调用fGLP RewardTracker合约，质押GLP并得到fGLP。 RewardRouter合约调用fsGLP RewardTracker合约，质押fGLP并得到fsGLP。 最终用户得到fsGLP。  4.5.2 GLP质押流程解读 GLP的Mint和质押流程需要先通过GlpManager合约，把输入的eth兑换成USDg，1 USDg = 1 USD。再用USDg来兑换GLP。完成GLP兑换后再通过fGLP RewardTracker合约和fsGLP RewardTracker合约的循环质押，最终得到fsGLP。\n fGLP RewardTracker合约是fGLP的ERC20合约，同时负责质押GLP并Mint fGLP。质押GLP可以获得平台手续费，以WETH结算。 fsGLP RewardTracker合约是fsGLP的ERC20合约，同时负责质押fGLP并Mint fsGLP。质押fGLP可以获得esGMX Token奖励。  相关合约地址\n   合约名称 合约地址     RewardRouter合约 0xa906f338cb21815cbc4bc87ace9e68c87ef8d8f1   GlpManager合约 0x3963ffc9dff443c2a94f21b129d429891e32ec18   Vault合约 0x489ee077994b6658eafa855c308275ead8097c4a   GLP合约 0x4277f8f2c384827b5273592ff7cebd9f2c1ac258   fGLP RewardTracker合约 0x4e971a87900b931ff39d1aad67697f49835400b6   fsGLP RewardTracker合约 0x1addd80e6039594ee970e5872d247bf0414c8903    相关交易操作交易Hash\n   操作名称 交易Hash     GLP质押 0x348cffb309afeafe3fa252c355e6f27251ab40bb9dfa48b0b0ee8c40cf95d9e1    4.5.3 GLP解除质押业务流程 GLP解除质押流程\n 用户调用RewardRouter合约，发起GLP解除质押和burn流程。 RewardRouter合约调用fsGLP RewardTracker合约，burn fsGLP并得到fGLP。 RewardRouter合约调用fGLP RewardTracker合约，burn fGLP并得到GLP。 RewardRouter合约调用GlpManager合约，发起GLP burn。 GlpManager合约调用GLP合约，burn GLP并得到USDg。 GlpManager合约调用Vault合约，burn USDG并得到eth。 最终用户得到ETH。  4.5.4 GLP解除质押流程解读 GLP解除质押就是质押流程的逆向操作，输入是fsGLP，最终得到ETH。\n相关合约地址\n   合约名称 合约地址     RewardRouter合约 0xa906f338cb21815cbc4bc87ace9e68c87ef8d8f1   GlpManager合约 0x3963ffc9dff443c2a94f21b129d429891e32ec18   Vault合约 0x489ee077994b6658eafa855c308275ead8097c4a   GLP合约 0x4277f8f2c384827b5273592ff7cebd9f2c1ac258   fGLP RewardTracker合约 0x4e971a87900b931ff39d1aad67697f49835400b6   fsGLP RewardTracker合约 0x1addd80e6039594ee970e5872d247bf0414c8903    相关交易操作交易Hash\n   操作名称 交易Hash     GLP解除质押 0x79b20a42a9ed410772fea136b0f45bf1f35ea77a2726aef170c1ba9612109888    4.6 GMX领取质押收益业务逻辑 4.6.1 GMX领取质押收益业务流程 GMX领取收益流程\n 用户调用RewardRouter合约发起领取收益流程。 RewardRouter合约调用gmxVester合约领取GMX收益。 RewardRouter合约调用glpVester合约领取GMX收益。 RewardRouter合约调用sGMX RewardTracker合约领取esGMX收益。 RewardRouter合约调用fsGLP RewardTracker合约领取esGMX收益。 RewardRouter合约调用sbGMX RewardTracker合约领取bnGMX收益。 RewardRouter合约调用sbfGMX RewardTracker合约领取平台手续费，以WETH结算。 RewardRouter合约调用fGLP RewardTracker合约领取平台手续费，以WETH结算。 RewardRouter合约收到的GMX、esGMX和WETH发送给用户。  4.6.2 GMX领取质押收益流程解读 领取质押收益主要由用户发起，RewardRouter合约来调用其它收益合约来领取收益。\nRewardTracker合约的收益计算公式 可领取收益 = 用户质押数量 * 质押时长 * 单位质押单位时间的收益率 其中，单位质押单位时间的收益率由管理员来设置。\ngmxVester合约和glpVester合约是什么 gmxVester合约和glpVester合约是用来转换esGMX到GMX的合约。收益计算公式为 可领取收益 = esGMX质押数量 * 质押时长 / vestingDuration 其中，vestingDuration由管理员设置，目前设置为1年时间。\n相关合约地址\n   合约名称 合约地址     RewardRouter合约 0xa906f338cb21815cbc4bc87ace9e68c87ef8d8f1   gmxVester合约 0x199070ddfd1cfb69173aa2f7e20906f26b363004   glpVester合约 0xa75287d2f8b217273e7fcd7e86ef07d33972042e   fGLP RewardTracker合约 0x4e971a87900b931ff39d1aad67697f49835400b6   fsGLP RewardTracker合约 0x1addd80e6039594ee970e5872d247bf0414c8903   sGMX RewardTracker合约 0x908c4d94d34924765f1edc22a1dd098397c59dd4   sbGMX RewardTracker合约 0x4d268a7d4c16ceb5a606c173bd974984343fea13   sbfGMX RewardTracker合约 0xd2d1162512f927a7e282ef43a362659e4f2a728f    相关交易操作交易Hash\n   操作名称 交易Hash     领取质押收益 0x2731c50c5b63e80779aaa97b14a1d25cdf1f4ecc414204d583238fb38c076096    4.7 GMX平台手续费归集并分配收入业务逻辑 4.7.1 GMX平台手续费归集并分配收入业务流程 业务流程\n 由平台管理员统一从Vault合约中领取平台手续费。 Vault合约把手续费都转移到平台手续费收益管理员。 平台手续费收益管理员调用Router合约把手续费全都转换成WETH。  Router合约会调用Vault合约进行token swap。   平台手续费收益管理员最后把手续费都转移到RewardDistributor合约。 GMX质押用户领取手续费的时候，sbfGMX RewardTracker合约会从sbfGMX RewardDistributor合约获取手续费收入。 GLP质押用户领取手续费的时候，fGLP RewardTracker合约会从fGLP RewardDistributor合约获取手续费收入。  4.7.2 GMX平台手续费归集并分配收入业务解读 从流程图中可以看出，目前手续费分配的逻辑还是比较中心化的，需要平台管理员EOA账户和平台手续费收益管理员EOA账户来控制。\n 平台管理员EOA账户主要负责提取手续费到平台手续费收益管理员EOA账户。 平台手续费收益管理员EOA账户主要负责把收到的手续费都换成WETH，并把WETH都转移到RewardDistributor合约。  相关合约地址\n   合约名称 合约地址     Timelock合约 0xe7e740fa40ca16b15b621b49de8e9f0d69cf4858   Vault合约 0x489ee077994b6658eafa855c308275ead8097c4a   Router合约 0xabbc5f99639c9b6bcb58544ddf04efa6802f4064   sbfGMX RewardDistributor合约 0x1de098faf30bd74f22753c28db17a2560d4f5554   fGLP RewardDistributor合约 0x5c04a12eb54a093c396f61355c6da0b15890150d    相关交易操作交易Hash\n   操作名称 交易Hash     平台管理员提取手续费收益 0x8c0c1ceae993b037d003a195a72147a702f772986de3b4076cf614edaf6834d0   手续费管理员执行Token Swap 0x2612bce63d085248fee6193b0ca3ba189d353bc7d3f5492017c7a6c7d933cbfd   手续费管理员执行Token Swap 0x4b1a039541b367d3fe38db73d491d58b9d9dd5baf7e34cd9bdd5286725634536   手续费管理员执行Token Swap 0x8c46063bde7e5f415e0c0c72974c22ca28814f284f268f4565a071734d13bc8b   手续费管理员执行Token Swap 0x0ea7999ad2cb34bbd88e88be66bb5f7758b4f33283d1d20bc82f7e4b507afdf3   手续费管理员执行Token Swap 0x40cfbc735a065d63f9058cbde762dc1ca7fe7e39308b7b216e285d62a246c206   手续费管理员执行Token Swap 0x0d39b2273b70f677543a6f204810dd3e16abc0adb09804a721b4502b68b2c8b2   手续费管理员把WETH转移到sbfGMX RewardDistributor合约 0xe77d0ef63db5a776b976dc13f46d5942b7a11ccad953e20f3c7b7ae88f888679   手续费管理员把WETH转移到fGLP RewardDistributor合约 0x71e030541f1e10cd866ab15fa7eb3c0645ddeccce5c782baa7eb05f8d2490613    5 总结 总体来看，除了平台手续费分配这块还比较中心化，其它部分都是由智能合约自动完成。因此，可以说整个项目还是比较去中心化。随着中心交易所FTX暴雷，未来使用去中心化交易所可以说是大势所趋，去中心化合约交易所更是兵家必争之地。GMX作为去中心合约交易的龙头，它的优势也是非常明显：\n 去中心化。GMX是一个去中心化的永续合约交易平台，所有资产由智能合约保管，智能合约开源，所有运营数据也是公开透明的。 全额保证金。GMX上面的所有杠杆订单都是有全额保证金的，保障用户的收益能够钢性对付，很多中心化交易所都无法做到全额保证金。 市场报价去中心化。系统报价主要由ChainLink和报价机器人组成，报价公开透明，有效避免了恶意插针等扰乱市场的行为。 它的劣势也非常明显： 币种太少。包括4种主流代币、4种稳定币，不能满足大部分用户的需求。 无法做到Permissionless。由于GMX的架构设计，无法像Uniswap那样自由添加代币，它只能预先设定好支持哪些代币，无法自由扩展代币种类。 但不可否认的是，GMX所在的赛道发展潜力巨大，未来一定会诞生超级巨头。虽然GMX目前是去中心化永续合约交易所的龙头，但是还需要升级改造，解决目前平台目前的问题，让用户能像使用中心化永续合约交易所一样去使用去中心化的永续合约交易所。  ","wordCount":"553","inLanguage":"en","datePublished":"2023-02-27T21:57:17+08:00","dateModified":"2023-02-27T21:57:17+08:00","author":{"@type":"Person","name":"Xuqi.Zhong"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://zhongxuqi.github.io/web3/2023-02-27/"},"publisher":{"@type":"Organization","name":"Xuqi.Zhong的博客","logo":{"@type":"ImageObject","url":"https://zhongxuqi.github.io/%3Clink%20/%20abs%20url%3E"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://zhongxuqi.github.io/ accesskey=h title="Xuqi.Zhong的博客 (Alt + H)"><img src=https://zhongxuqi.github.io/apple-touch-icon.png alt aria-label=logo height=35>Xuqi.Zhong的博客</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://zhongxuqi.github.io/ title=Home><span>Home</span></a></li><li><a href=https://zhongxuqi.github.io/web3 title=Web3><span>Web3</span></a></li><li><a href=https://zhongxuqi.github.io/blockchain title=Blockchain><span>Blockchain</span></a></li><li><a href=https://zhongxuqi.github.io/archives title=Archives><span>Archives</span></a></li><li><a href=https://zhongxuqi.github.io/search title="Search (Alt + /)" accesskey=/><span>Search</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://zhongxuqi.github.io/>Home</a>&nbsp;»&nbsp;<a href=https://zhongxuqi.github.io/web3/>Web3s</a></div><h1 class=post-title>深度解读GMX：去中心化永续合约交易所</h1><div class=post-meta><span title="2023-02-27 21:57:17 +0800 CST">2023-02-27</span>&nbsp;·&nbsp;3 min&nbsp;·&nbsp;553 words&nbsp;·&nbsp;Xuqi.Zhong</div></header><div class=post-content><h1 id=0-gmx项目发展史>0 GMX项目发展史<a hidden class=anchor aria-hidden=true href=#0-gmx项目发展史>#</a></h1><p>在2020年10月，xvi10启动了 <a href=https://github.com/xvi10/xvix-contracts>xvix-contracts</a> 项目，并部署到了Ethereum Mainnet。
在2021年3月，xvi10把 <a href=https://github.com/xvi10/xvix-contracts>xvix-contracts</a> 升级为 <a href=https://github.com/xvi10/gambit-contracts>gambit-contracts</a> ，并部署到了BSC。
在2021年9月，xvi10基于 <a href=https://github.com/xvi10/gambit-contracts>gambit-contracts</a> 启动GMX项目，并部署到了Arbitrum One。
在启动一周后，GMX完成了第一次升级，在eth、wbtc和usdc的基础上，添加了link、uni和usdt。 在启动三个月后，GMX，完成了第二次升级，部署到了Avalanche链上。</p><h1 id=1-gmx的产品设计目标>1 GMX的产品设计目标<a hidden class=anchor aria-hidden=true href=#1-gmx的产品设计目标>#</a></h1><p>GMX的产品设计目标是打造一个去中心化的永续合约和现货交易平台。不需要任何注册、KYC和地域限制等限制，用户即可方便地用它进行链上资产交易和合约交易。</p><h1 id=2-gmx的核心卖点>2 GMX的核心卖点<a hidden class=anchor aria-hidden=true href=#2-gmx的核心卖点>#</a></h1><ol><li><strong>去中心化</strong>。GMX是一个去中心化的永续合约交易平台，所有资产由智能合约保管，智能合约开源，所有运营数据也是公开透明的。</li><li><strong>全额保证金</strong>。GMX上面的所有杠杆订单都是有全额保证金的，保障用户的收益能够钢性对付，很多中心化交易所都无法做到全额保证金。</li><li><strong>无需许可Permissionless</strong>。所有人都可以公平得参与平台做市，并且根据GMX和GLP持有量平等地分到平台的盈利。</li><li><strong>市场报价去中心化</strong>。系统报价主要由ChainLink和报价机器人组成，报价公开透明，有效避免了恶意插针等扰乱市场的行为。</li></ol><h1 id=3-gmx的系统整体设计>3 GMX的系统整体设计<a hidden class=anchor aria-hidden=true href=#3-gmx的系统整体设计>#</a></h1><h2 id=31-gmx系统架构图>3.1 GMX系统架构图<a hidden class=anchor aria-hidden=true href=#31-gmx系统架构图>#</a></h2><p><img loading=lazy src=/web3/gmx/%e6%9e%b6%e6%9e%84%e5%9b%be.svg alt=架构图.svg>
其中，Vault合约是整个GMX的核心，负责管理GMX平台的全部资产。</p><h2 id=32-系统核心数据模型>3.2 系统核心数据模型<a hidden class=anchor aria-hidden=true href=#32-系统核心数据模型>#</a></h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=display:flex><span>{
</span></span><span style=display:flex><span>	<span style=color:#e6db74>&#34;id&#34;</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>keccak256</span>(<span style=color:#a6e22e>_account</span>, <span style=color:#a6e22e>_collateralToken</span>, <span style=color:#a6e22e>_indexToken</span>, <span style=color:#a6e22e>_isLong</span>), <span style=color:#75715e>// 仓位ID
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>	<span style=color:#e6db74>&#34;size&#34;</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>uint256</span>, <span style=color:#75715e>// Position大小
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>	<span style=color:#e6db74>&#34;collateral&#34;</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>uint256</span>, <span style=color:#75715e>// 抵押品价格 USD
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>	<span style=color:#e6db74>&#34;averagePrice&#34;</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>uint256</span>, <span style=color:#75715e>// 平均持仓价格 USD
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>	<span style=color:#e6db74>&#34;entryFundingRate&#34;</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>uint256</span>, <span style=color:#75715e>// 入场资金费率
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>	<span style=color:#e6db74>&#34;reserveAmount&#34;</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>uint256</span>, <span style=color:#75715e>// 抵押品token储备数量
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>	<span style=color:#e6db74>&#34;realisedPnl&#34;</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>int256</span>, <span style=color:#75715e>// 已兑付盈亏
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>	<span style=color:#e6db74>&#34;lastIncreasedTime&#34;</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>uint256</span>, <span style=color:#75715e>// 最后加仓时间
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>}
</span></span></code></pre></div><p>盈亏USD价值计算：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=display:flex><span><span style=color:#a6e22e>delta</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>position</span>.<span style=color:#a6e22e>size</span> <span style=color:#f92672>*</span> (<span style=color:#a6e22e>currentPrice</span> <span style=color:#f92672>-</span> <span style=color:#a6e22e>position</span>.<span style=color:#a6e22e>averagePrice</span>)  <span style=color:#f92672>/</span> <span style=color:#a6e22e>position</span>.<span style=color:#a6e22e>averagePrice</span>
</span></span></code></pre></div><h1 id=4-gmx核心业务逻辑解读>4 GMX核心业务逻辑解读<a hidden class=anchor aria-hidden=true href=#4-gmx核心业务逻辑解读>#</a></h1><p>了解了GMX系统设计框架，那么解析来就逐个解析它的核心业务流程。</p><h2 id=41-gmx加减仓业务逻辑>4.1 GMX加减仓业务逻辑<a hidden class=anchor aria-hidden=true href=#41-gmx加减仓业务逻辑>#</a></h2><h3 id=411-gmx加减仓业务流程>4.1.1 GMX加减仓业务流程<a hidden class=anchor aria-hidden=true href=#411-gmx加减仓业务流程>#</a></h3><p><img loading=lazy src=/web3/gmx/GMX%e5%8a%a0%e5%87%8f%e4%bb%93%e6%b5%81%e7%a8%8b.svg alt=GMX加减仓流程.svg>
<strong>创建订单流程</strong></p><ol><li>用户在Web页面发起市价或者限价单，并发送Transaction到链上。</li><li>Transaction会根据用户的提交参数，选择调用市价单或者限价单合约来创建订单。</li><li>结束，等待交易机器人执行交易。</li></ol><p><strong>执行订单流程</strong></p><ol><li>执行交易机器人根据市场价选择执行市价单或者限价单，并发送交易到链上。</li><li>Transaction会根据会根据机器人的提交参数，选择调用市价单或者限价单合约和执行订单。</li><li>市价单或者限价单合约会调用Vault合约来执行加减仓操作。</li></ol><h3 id=412-gmx加减仓流程解读>4.1.2 GMX加减仓流程解读<a hidden class=anchor aria-hidden=true href=#412-gmx加减仓流程解读>#</a></h3><p>从加减仓业务流程中可以看出，订单的创建和执行是2个独立的步骤。首先，用户创建市价单和限价单，并由市价单合约和限价单合约来保存订单数据。然后，订单执行机器人会异步调用市价单合约和限价单合约来执行订单。订单执行机器人可以根据当前的市价选择哪些订单可以被执行。</p><p><strong>手续费 = 交易手续费 + 资金费用</strong></p><ol><li>交易手续费：价减仓USD金额 * 0.1%。</li><li>资金费用：仓位总USD价值 * 时间间隔 * 单位USD单位时间间隔的费率。</li></ol><p><strong>爆仓条件</strong>
另外还需要判断是否爆仓，满足一下条件之一就有可能爆仓。</p><ol><li>条件一：抵押品总USD价值 + 仓位盈亏USD价值 &lt; 资金USD费用 + 清算USD费用。</li><li>条件二：(抵押品总USD价值 + 仓位盈亏USD价值) * 最大杠杆倍数 &lt; 仓位总USD价值。
其中，清算USD费用由管理员设置。</li></ol><p><strong>相关合约地址</strong></p><table><thead><tr><th>合约名称</th><th>合约地址</th></tr></thead><tbody><tr><td>市价单合约</td><td><a href=https://arbiscan.io/address/0xb87a436b93ffe9d75c5cfa7bacfff96430b09868>0xb87a436b93ffe9d75c5cfa7bacfff96430b09868</a></td></tr><tr><td>限价单合约</td><td><a href=https://arbiscan.io/address/0x09f77e8a13de9a35a7231028187e9fd5db8a2acb>0x09f77e8a13de9a35a7231028187e9fd5db8a2acb</a></td></tr><tr><td>Vault合约</td><td><a href=https://arbiscan.io/address/0x489ee077994b6658eafa855c308275ead8097c4a>0x489ee077994b6658eafa855c308275ead8097c4a</a></td></tr></tbody></table><p><strong>相关交易操作交易Hash</strong></p><table><thead><tr><th>操作名称</th><th>交易Hash</th></tr></thead><tbody><tr><td>用户发起市价单加仓交易</td><td><a href=https://arbiscan.io/tx/0x3230e702a44c6029790d279d0a11e87f89474a9fec251aa0b7f5070aab38104b>0x3230e702a44c6029790d279d0a11e87f89474a9fec251aa0b7f5070aab38104b</a></td></tr><tr><td>用户发起市价单减仓交易</td><td><a href=https://arbiscan.io/tx/0x7d359cb6a1744f87c6b4cc1ff93a8b8ee9fc6bbfa73227e8c7d8b59214a8a368>0x7d359cb6a1744f87c6b4cc1ff93a8b8ee9fc6bbfa73227e8c7d8b59214a8a368</a></td></tr><tr><td>执行机器人执行市价单</td><td><a href=https://arbiscan.io/tx/0x5f5a3a90ed30b099ad456f14e7ea580cea3f25cd4bdf2d491ae5e18eadd87ff2>0x5f5a3a90ed30b099ad456f14e7ea580cea3f25cd4bdf2d491ae5e18eadd87ff2</a></td></tr><tr><td>执行机器人执行限价单</td><td><a href=https://arbiscan.io/tx/0x3cc5b3bd1fc5efeba0cbf1cfc5752773d9476c15b2fb8cc3bb5dc02b8480b5af>0x3cc5b3bd1fc5efeba0cbf1cfc5752773d9476c15b2fb8cc3bb5dc02b8480b5af</a></td></tr></tbody></table><h2 id=42-gmx清算业务逻辑>4.2 GMX清算业务逻辑<a hidden class=anchor aria-hidden=true href=#42-gmx清算业务逻辑>#</a></h2><h3 id=421-gmx清算业务流程>4.2.1 GMX清算业务流程<a hidden class=anchor aria-hidden=true href=#421-gmx清算业务流程>#</a></h3><p><img loading=lazy src=/web3/gmx/GMX%e6%b8%85%e7%ae%97%e4%b8%9a%e5%8a%a1%e6%b5%81%e7%a8%8b.svg alt=GMX清算业务流程.svg>
<strong>清算流程</strong></p><ol><li>清算机器人发送清算交易，并广播到链上</li><li>仓位管理合约调用Vault合约执行清算逻辑</li></ol><h3 id=422-gmx清算流程解读>4.2.2 GMX清算流程解读<a hidden class=anchor aria-hidden=true href=#422-gmx清算流程解读>#</a></h3><p>清算流程主要清算机器人来发起，清算机器人会监控合约中的Position，并调用合约方法来对爆仓的Position进行清算。完成清算任务后，清算机器人收到一笔清算手续费。</p><p><strong>仓位清算条件</strong>
满足一下条件之一就可以被清算</p><ol><li>条件一：抵押品总USD价值 + 仓位盈亏USD价值 &lt; 资金USD费用 + 清算USD费用</li><li>条件二：(抵押品总USD价值 + 仓位盈亏USD价值) * 最大杠杆倍数 &lt; 仓位总USD价值
其中，清算USD费用大小由管理员设置。</li></ol><p><strong>相关合约地址</strong></p><table><thead><tr><th>合约名称</th><th>合约地址</th></tr></thead><tbody><tr><td>仓位管理合约</td><td><a href=https://arbiscan.io/address/0x75e42e6f01baf1d6022bea862a28774a9f8a4a0c>0x75e42e6f01baf1d6022bea862a28774a9f8a4a0c</a></td></tr><tr><td>Vault合约</td><td><a href=https://arbiscan.io/address/0x489ee077994b6658eafa855c308275ead8097c4a>0x489ee077994b6658eafa855c308275ead8097c4a</a></td></tr></tbody></table><p><strong>相关交易操作交易Hash</strong></p><table><thead><tr><th>操作名称</th><th>交易Hash</th></tr></thead><tbody><tr><td>清算机器人发起清算流程</td><td><a href=https://arbiscan.io/tx/0xccca7adf093d4e20ed25d2d479419a1efaac964c337beea958f214b4db195c34>0xccca7adf093d4e20ed25d2d479419a1efaac964c337beea958f214b4db195c34</a></td></tr></tbody></table><h2 id=43-gmx现货交易业务逻辑>4.3 GMX现货交易业务逻辑<a hidden class=anchor aria-hidden=true href=#43-gmx现货交易业务逻辑>#</a></h2><h3 id=431-gmx现货交易业务流程>4.3.1 GMX现货交易业务流程<a hidden class=anchor aria-hidden=true href=#431-gmx现货交易业务流程>#</a></h3><p><img loading=lazy src=/web3/gmx/GMX%e7%8e%b0%e8%b4%a7%e4%ba%a4%e6%98%93%e6%b5%81%e7%a8%8b.svg alt=GMX现货交易流程.svg></p><p><strong>现货交易流程</strong></p><ol><li>用户发起现货交易，并广播到链上。</li><li>Router合约调用Vault合约执行现货交易。</li><li>Vault合约从Token价格合约获取价格，并执行交易</li></ol><h3 id=432-gmx现货交易流程解读>4.3.2 GMX现货交易流程解读<a hidden class=anchor aria-hidden=true href=#432-gmx现货交易流程解读>#</a></h3><p>GMX的现货交易不是主流的AMM，而是通过Chainlink获取TokenIn价格，然后计算出TokenOut的数量。具体计算过程如下</p><ol><li>先从Token价格合约获取tokenInUSDPrice和tokenOutUSDPrice。</li><li>计算tokenOutAmount：<code>tokenOutAmount = tokenInAmount * tokenInUSDPrice / tokenOutUSDPrice</code>。</li></ol><p><strong>相关合约地址</strong></p><table><thead><tr><th>合约名称</th><th>合约地址</th></tr></thead><tbody><tr><td>Router合约</td><td><a href=https://arbiscan.io/address/0xabbc5f99639c9b6bcb58544ddf04efa6802f4064>0xabbc5f99639c9b6bcb58544ddf04efa6802f4064</a></td></tr><tr><td>Vault合约</td><td><a href=https://arbiscan.io/address/0x489ee077994b6658eafa855c308275ead8097c4a>0x489ee077994b6658eafa855c308275ead8097c4a</a></td></tr><tr><td>Token价格合约</td><td><a href=https://arbiscan.io/address/0x2d68011bca022ed0e474264145f46cc4de96a002>0x2d68011bca022ed0e474264145f46cc4de96a002</a></td></tr></tbody></table><p><strong>相关交易操作交易Hash</strong></p><table><thead><tr><th>操作名称</th><th>交易Hash</th></tr></thead><tbody><tr><td>用户发起现货交易</td><td><a href=https://arbiscan.io/tx/0x0da7809c5f6372b5cc7342493fa405d0215d56ac47167b2682797df3ac4fca64>0x0da7809c5f6372b5cc7342493fa405d0215d56ac47167b2682797df3ac4fca64</a></td></tr></tbody></table><h2 id=44-gmx质押和解除业务逻辑>4.4 GMX质押和解除业务逻辑<a hidden class=anchor aria-hidden=true href=#44-gmx质押和解除业务逻辑>#</a></h2><h3 id=441-gmx质押业务流程>4.4.1 GMX质押业务流程<a hidden class=anchor aria-hidden=true href=#441-gmx质押业务流程>#</a></h3><p><img loading=lazy src=/web3/gmx/GMX%e8%b4%a8%e6%8a%bc%e6%b5%81%e7%a8%8b.svg alt=GMX质押流程.svg>
<strong>GMX质押流程</strong></p><ol><li>用户向RewardRouter合约发起GMX质押。</li><li>RewardRouter合约调用sGMX RewardTracker合约，质押GMX并得到sGMX。</li><li>RewardRouter合约调用sbGMX RewardTracker合约，质押sGMX并得到sbGMX。</li><li>RewardRouter合约调用sbfGMX RewardTracker合约，质押sbGMX并得到sbfGMX。</li><li>用户最终得到sbfGMX。</li></ol><h3 id=442-gmx质押流程解读>4.4.2 GMX质押流程解读<a hidden class=anchor aria-hidden=true href=#442-gmx质押流程解读>#</a></h3><p>质押业务由用户发起，质押核心业务逻辑在RewardRouter核心实现。质押具体逻辑主要由sGMX RewardTracker合约、sbGMX RewardTracker合约和sbfGMX RewardTracker合约来实现，它们的作用分别为</p><ul><li>sGMX RewardTracker合约是sGMX的ERC20合约，同时负责质押GMX并Mint sGMX。质押GMX的用户可以获取esGMX Token奖励。</li><li>sbGMX RewardTracker合约是sbGMX的ERC20合约，同时负责质押sGMX并Mint sbGMX。质押sGMX的用户可以获取bnGMX Token奖励。</li><li>sbfGMX RewardTracker合约是sbfGMX的ERC20合约，同时负责质押sbGMX并Mint sbfGMX。质押sbGMX的用户可以获取平台手续费，以WETH结算。
这样做的好处是RewardTracker合约即作为ERC20合约，又负责了质押业务，节省了合约gas成本。</li></ul><p><strong>esGMX是什么</strong>
esGMX等同与GMX，但是esGMX无法转账交易。用户可以把esGMX质押到gmxVestor合约，一年时间内esGMX就会在一年时间内线性地转换为GMX。</p><p><strong>bnGMX是什么</strong>
bnGMX会在restake进行二次质押，并且提升用户的APR。但是在unstake的时候，就会burn掉。</p><p><strong>相关合约地址</strong></p><table><thead><tr><th>合约名称</th><th>合约地址</th></tr></thead><tbody><tr><td>RewardRouter合约</td><td><a href=https://arbiscan.io/address/0xa906f338cb21815cbc4bc87ace9e68c87ef8d8f1>0xa906f338cb21815cbc4bc87ace9e68c87ef8d8f1</a></td></tr><tr><td>sGMX RewardTracker合约</td><td><a href=https://arbiscan.io/address/0x908c4d94d34924765f1edc22a1dd098397c59dd4>0x908c4d94d34924765f1edc22a1dd098397c59dd4</a></td></tr><tr><td>sbGMX RewardTracker合约</td><td><a href=https://arbiscan.io/address/0x4d268a7d4c16ceb5a606c173bd974984343fea13>0x4d268a7d4c16ceb5a606c173bd974984343fea13</a></td></tr><tr><td>sbfGMX RewardTracker合约</td><td><a href=https://arbiscan.io/address/0xd2d1162512f927a7e282ef43a362659e4f2a728f>0xd2d1162512f927a7e282ef43a362659e4f2a728f</a></td></tr></tbody></table><p><strong>相关交易操作交易Hash</strong></p><table><thead><tr><th>操作名称</th><th>交易Hash</th></tr></thead><tbody><tr><td>GMX质押</td><td><a href=https://arbiscan.io/tx/0xf885f7691effca2b0ba23423fa38941d3c2341598c6de208f025375e91d3c4e1>0xf885f7691effca2b0ba23423fa38941d3c2341598c6de208f025375e91d3c4e1</a></td></tr></tbody></table><h3 id=443-gmx解除质押业务流程>4.4.3 GMX解除质押业务流程<a hidden class=anchor aria-hidden=true href=#443-gmx解除质押业务流程>#</a></h3><p><img loading=lazy src=/web3/gmx/GMX%e8%a7%a3%e9%99%a4%e8%b4%a8%e6%8a%bc%e6%b5%81%e7%a8%8b.svg alt=GMX解除质押流程.svg>
<strong>GMX解除质押流程</strong></p><ol><li>用户向RewardRouter合约发起GMX解除质押</li><li>RewardRouter合约调用sbfGMX RewardTracker合约，解除质押sbfGMX并得到sbGMX</li><li>RewardRouter合约调用sbGMX RewardTracker合约，解除质押sbGMX并得到sGMX</li><li>RewardRouter合约调用sGMX RewardTracker合约，解除质押sGMX并得到GMX</li><li>用户最终得到GMX</li></ol><h3 id=444-gmx解除质押流程解读>4.4.4 GMX解除质押流程解读<a hidden class=anchor aria-hidden=true href=#444-gmx解除质押流程解读>#</a></h3><p>GMX解除质押业务流程就是质押流程的逆向操作，输入是sbfGMX，最终得到GMX。</p><p><strong>相关合约地址</strong></p><table><thead><tr><th>合约名称</th><th>合约地址</th></tr></thead><tbody><tr><td>RewardRouter合约</td><td><a href=https://arbiscan.io/address/0xa906f338cb21815cbc4bc87ace9e68c87ef8d8f1>0xa906f338cb21815cbc4bc87ace9e68c87ef8d8f1</a></td></tr><tr><td>sGMX RewardTracker合约</td><td><a href=https://arbiscan.io/address/0x908c4d94d34924765f1edc22a1dd098397c59dd4>0x908c4d94d34924765f1edc22a1dd098397c59dd4</a></td></tr><tr><td>sbGMX RewardTracker合约</td><td><a href=https://arbiscan.io/address/0x4d268a7d4c16ceb5a606c173bd974984343fea13>0x4d268a7d4c16ceb5a606c173bd974984343fea13</a></td></tr><tr><td>sbfGMX RewardTracker合约</td><td><a href=https://arbiscan.io/address/0xd2d1162512f927a7e282ef43a362659e4f2a728f>0xd2d1162512f927a7e282ef43a362659e4f2a728f</a></td></tr></tbody></table><p><strong>相关交易操作交易Hash</strong></p><table><thead><tr><th>操作名称</th><th>交易Hash</th></tr></thead><tbody><tr><td>GMX解除质押</td><td><a href=https://arbiscan.io/tx/0x1dc5efbc0ddfe09c3596407d1974647b787f77794a415e81df11ff21e8d683c3>0x1dc5efbc0ddfe09c3596407d1974647b787f77794a415e81df11ff21e8d683c3</a></td></tr></tbody></table><h2 id=45-glp质押和解除业务逻辑>4.5 GLP质押和解除业务逻辑<a hidden class=anchor aria-hidden=true href=#45-glp质押和解除业务逻辑>#</a></h2><h3 id=451-glp质押业务流程>4.5.1 GLP质押业务流程<a hidden class=anchor aria-hidden=true href=#451-glp质押业务流程>#</a></h3><p><img loading=lazy src=/web3/gmx/GLP%e8%b4%a8%e6%8a%bc%e6%b5%81%e7%a8%8b.svg alt=GLP质押流程.svg>
<strong>GLP质押流程</strong></p><ol><li>用户调用RewardRouter合约，发起GLP Mint和质押流程。</li><li>RewardRouter合约调用GlpManager合约，发起GLP Mint。</li><li>GlpManager合约调用Vault合约，消耗eth并mint 相应数量的USDg。</li><li>GlpManager合约调用GLP合约，消耗USDg并Mint GLP。</li><li>RewardRouter合约调用fGLP RewardTracker合约，质押GLP并得到fGLP。</li><li>RewardRouter合约调用fsGLP RewardTracker合约，质押fGLP并得到fsGLP。</li><li>最终用户得到fsGLP。</li></ol><h3 id=452-glp质押流程解读>4.5.2 GLP质押流程解读<a hidden class=anchor aria-hidden=true href=#452-glp质押流程解读>#</a></h3><p>GLP的Mint和质押流程需要先通过GlpManager合约，把输入的eth兑换成USDg，1 USDg = 1 USD。再用USDg来兑换GLP。完成GLP兑换后再通过fGLP RewardTracker合约和fsGLP RewardTracker合约的循环质押，最终得到fsGLP。</p><ul><li>fGLP RewardTracker合约是fGLP的ERC20合约，同时负责质押GLP并Mint fGLP。质押GLP可以获得平台手续费，以WETH结算。</li><li>fsGLP RewardTracker合约是fsGLP的ERC20合约，同时负责质押fGLP并Mint fsGLP。质押fGLP可以获得esGMX Token奖励。</li></ul><p><strong>相关合约地址</strong></p><table><thead><tr><th>合约名称</th><th>合约地址</th></tr></thead><tbody><tr><td>RewardRouter合约</td><td><a href=https://arbiscan.io/address/0xa906f338cb21815cbc4bc87ace9e68c87ef8d8f1>0xa906f338cb21815cbc4bc87ace9e68c87ef8d8f1</a></td></tr><tr><td>GlpManager合约</td><td><a href=https://arbiscan.io/address/0x3963ffc9dff443c2a94f21b129d429891e32ec18>0x3963ffc9dff443c2a94f21b129d429891e32ec18</a></td></tr><tr><td>Vault合约</td><td><a href=https://arbiscan.io/address/0x489ee077994b6658eafa855c308275ead8097c4a>0x489ee077994b6658eafa855c308275ead8097c4a</a></td></tr><tr><td>GLP合约</td><td><a href=https://arbiscan.io/address/0x4277f8f2c384827b5273592ff7cebd9f2c1ac258>0x4277f8f2c384827b5273592ff7cebd9f2c1ac258</a></td></tr><tr><td>fGLP RewardTracker合约</td><td><a href=https://arbiscan.io/address/0x4e971a87900b931ff39d1aad67697f49835400b6>0x4e971a87900b931ff39d1aad67697f49835400b6</a></td></tr><tr><td>fsGLP RewardTracker合约</td><td><a href=https://arbiscan.io/address/0x1addd80e6039594ee970e5872d247bf0414c8903>0x1addd80e6039594ee970e5872d247bf0414c8903</a></td></tr></tbody></table><p><strong>相关交易操作交易Hash</strong></p><table><thead><tr><th>操作名称</th><th>交易Hash</th></tr></thead><tbody><tr><td>GLP质押</td><td><a href=https://arbiscan.io/tx/0x348cffb309afeafe3fa252c355e6f27251ab40bb9dfa48b0b0ee8c40cf95d9e1>0x348cffb309afeafe3fa252c355e6f27251ab40bb9dfa48b0b0ee8c40cf95d9e1</a></td></tr></tbody></table><h3 id=453-glp解除质押业务流程>4.5.3 GLP解除质押业务流程<a hidden class=anchor aria-hidden=true href=#453-glp解除质押业务流程>#</a></h3><p><img loading=lazy src=/web3/gmx/GLP%e8%a7%a3%e9%99%a4%e8%b4%a8%e6%8a%bc%e6%b5%81%e7%a8%8b.svg alt=GLP解除质押流程.svg>
<strong>GLP解除质押流程</strong></p><ol><li>用户调用RewardRouter合约，发起GLP解除质押和burn流程。</li><li>RewardRouter合约调用fsGLP RewardTracker合约，burn fsGLP并得到fGLP。</li><li>RewardRouter合约调用fGLP RewardTracker合约，burn fGLP并得到GLP。</li><li>RewardRouter合约调用GlpManager合约，发起GLP burn。</li><li>GlpManager合约调用GLP合约，burn GLP并得到USDg。</li><li>GlpManager合约调用Vault合约，burn USDG并得到eth。</li><li>最终用户得到ETH。</li></ol><h3 id=454-glp解除质押流程解读>4.5.4 GLP解除质押流程解读<a hidden class=anchor aria-hidden=true href=#454-glp解除质押流程解读>#</a></h3><p>GLP解除质押就是质押流程的逆向操作，输入是fsGLP，最终得到ETH。</p><p><strong>相关合约地址</strong></p><table><thead><tr><th>合约名称</th><th>合约地址</th></tr></thead><tbody><tr><td>RewardRouter合约</td><td><a href=https://arbiscan.io/address/0xa906f338cb21815cbc4bc87ace9e68c87ef8d8f1>0xa906f338cb21815cbc4bc87ace9e68c87ef8d8f1</a></td></tr><tr><td>GlpManager合约</td><td><a href=https://arbiscan.io/address/0x3963ffc9dff443c2a94f21b129d429891e32ec18>0x3963ffc9dff443c2a94f21b129d429891e32ec18</a></td></tr><tr><td>Vault合约</td><td><a href=https://arbiscan.io/address/0x489ee077994b6658eafa855c308275ead8097c4a>0x489ee077994b6658eafa855c308275ead8097c4a</a></td></tr><tr><td>GLP合约</td><td><a href=https://arbiscan.io/address/0x4277f8f2c384827b5273592ff7cebd9f2c1ac258>0x4277f8f2c384827b5273592ff7cebd9f2c1ac258</a></td></tr><tr><td>fGLP RewardTracker合约</td><td><a href=https://arbiscan.io/address/0x4e971a87900b931ff39d1aad67697f49835400b6>0x4e971a87900b931ff39d1aad67697f49835400b6</a></td></tr><tr><td>fsGLP RewardTracker合约</td><td><a href=https://arbiscan.io/address/0x1addd80e6039594ee970e5872d247bf0414c8903>0x1addd80e6039594ee970e5872d247bf0414c8903</a></td></tr></tbody></table><p><strong>相关交易操作交易Hash</strong></p><table><thead><tr><th>操作名称</th><th>交易Hash</th></tr></thead><tbody><tr><td>GLP解除质押</td><td><a href=https://arbiscan.io/tx/0x79b20a42a9ed410772fea136b0f45bf1f35ea77a2726aef170c1ba9612109888>0x79b20a42a9ed410772fea136b0f45bf1f35ea77a2726aef170c1ba9612109888</a></td></tr></tbody></table><h2 id=46-gmx领取质押收益业务逻辑>4.6 GMX领取质押收益业务逻辑<a hidden class=anchor aria-hidden=true href=#46-gmx领取质押收益业务逻辑>#</a></h2><h3 id=461-gmx领取质押收益业务流程>4.6.1 GMX领取质押收益业务流程<a hidden class=anchor aria-hidden=true href=#461-gmx领取质押收益业务流程>#</a></h3><p><img loading=lazy src=/web3/gmx/GMX%e9%a2%86%e5%8f%96%e6%94%b6%e7%9b%8a%e6%b5%81%e7%a8%8b.svg alt=GMX领取收益流程.svg>
<strong>GMX领取收益流程</strong></p><ol><li>用户调用RewardRouter合约发起领取收益流程。</li><li>RewardRouter合约调用gmxVester合约领取GMX收益。</li><li>RewardRouter合约调用glpVester合约领取GMX收益。</li><li>RewardRouter合约调用sGMX RewardTracker合约领取esGMX收益。</li><li>RewardRouter合约调用fsGLP RewardTracker合约领取esGMX收益。</li><li>RewardRouter合约调用sbGMX RewardTracker合约领取bnGMX收益。</li><li>RewardRouter合约调用sbfGMX RewardTracker合约领取平台手续费，以WETH结算。</li><li>RewardRouter合约调用fGLP RewardTracker合约领取平台手续费，以WETH结算。</li><li>RewardRouter合约收到的GMX、esGMX和WETH发送给用户。</li></ol><h3 id=462-gmx领取质押收益流程解读>4.6.2 GMX领取质押收益流程解读<a hidden class=anchor aria-hidden=true href=#462-gmx领取质押收益流程解读>#</a></h3><p>领取质押收益主要由用户发起，RewardRouter合约来调用其它收益合约来领取收益。</p><p><strong>RewardTracker合约的收益计算公式</strong>
可领取收益 = 用户质押数量 * 质押时长 * 单位质押单位时间的收益率
其中，单位质押单位时间的收益率由管理员来设置。</p><p><strong>gmxVester合约和glpVester合约是什么</strong>
gmxVester合约和glpVester合约是用来转换esGMX到GMX的合约。收益计算公式为
可领取收益 = esGMX质押数量 * 质押时长 / vestingDuration
其中，vestingDuration由管理员设置，目前设置为1年时间。</p><p><strong>相关合约地址</strong></p><table><thead><tr><th>合约名称</th><th>合约地址</th></tr></thead><tbody><tr><td>RewardRouter合约</td><td><a href=https://arbiscan.io/address/0xa906f338cb21815cbc4bc87ace9e68c87ef8d8f1>0xa906f338cb21815cbc4bc87ace9e68c87ef8d8f1</a></td></tr><tr><td>gmxVester合约</td><td><a href=https://arbiscan.io/address/0x199070ddfd1cfb69173aa2f7e20906f26b363004>0x199070ddfd1cfb69173aa2f7e20906f26b363004</a></td></tr><tr><td>glpVester合约</td><td><a href=https://arbiscan.io/address/0xa75287d2f8b217273e7fcd7e86ef07d33972042e>0xa75287d2f8b217273e7fcd7e86ef07d33972042e</a></td></tr><tr><td>fGLP RewardTracker合约</td><td><a href=https://arbiscan.io/address/0x4e971a87900b931ff39d1aad67697f49835400b6>0x4e971a87900b931ff39d1aad67697f49835400b6</a></td></tr><tr><td>fsGLP RewardTracker合约</td><td><a href=https://arbiscan.io/address/0x1addd80e6039594ee970e5872d247bf0414c8903>0x1addd80e6039594ee970e5872d247bf0414c8903</a></td></tr><tr><td>sGMX RewardTracker合约</td><td><a href=https://arbiscan.io/address/0x908c4d94d34924765f1edc22a1dd098397c59dd4>0x908c4d94d34924765f1edc22a1dd098397c59dd4</a></td></tr><tr><td>sbGMX RewardTracker合约</td><td><a href=https://arbiscan.io/address/0x4d268a7d4c16ceb5a606c173bd974984343fea13>0x4d268a7d4c16ceb5a606c173bd974984343fea13</a></td></tr><tr><td>sbfGMX RewardTracker合约</td><td><a href=https://arbiscan.io/address/0xd2d1162512f927a7e282ef43a362659e4f2a728f>0xd2d1162512f927a7e282ef43a362659e4f2a728f</a></td></tr></tbody></table><p><strong>相关交易操作交易Hash</strong></p><table><thead><tr><th>操作名称</th><th>交易Hash</th></tr></thead><tbody><tr><td>领取质押收益</td><td><a href=https://arbiscan.io/tx/0x2731c50c5b63e80779aaa97b14a1d25cdf1f4ecc414204d583238fb38c076096>0x2731c50c5b63e80779aaa97b14a1d25cdf1f4ecc414204d583238fb38c076096</a></td></tr></tbody></table><h2 id=47-gmx平台手续费归集并分配收入业务逻辑>4.7 GMX平台手续费归集并分配收入业务逻辑<a hidden class=anchor aria-hidden=true href=#47-gmx平台手续费归集并分配收入业务逻辑>#</a></h2><h3 id=471-gmx平台手续费归集并分配收入业务流程>4.7.1 GMX平台手续费归集并分配收入业务流程<a hidden class=anchor aria-hidden=true href=#471-gmx平台手续费归集并分配收入业务流程>#</a></h3><p><img loading=lazy src=/web3/gmx/GMX%e6%89%8b%e7%bb%ad%e8%b4%b9%e5%bd%92%e9%9b%86.svg alt=GMX手续费归集.svg>
<strong>业务流程</strong></p><ol><li>由平台管理员统一从Vault合约中领取平台手续费。</li><li>Vault合约把手续费都转移到平台手续费收益管理员。</li><li>平台手续费收益管理员调用Router合约把手续费全都转换成WETH。<ol><li>Router合约会调用Vault合约进行token swap。</li></ol></li><li>平台手续费收益管理员最后把手续费都转移到RewardDistributor合约。</li><li>GMX质押用户领取手续费的时候，sbfGMX RewardTracker合约会从sbfGMX RewardDistributor合约获取手续费收入。</li><li>GLP质押用户领取手续费的时候，fGLP RewardTracker合约会从fGLP RewardDistributor合约获取手续费收入。</li></ol><h3 id=472-gmx平台手续费归集并分配收入业务解读>4.7.2 GMX平台手续费归集并分配收入业务解读<a hidden class=anchor aria-hidden=true href=#472-gmx平台手续费归集并分配收入业务解读>#</a></h3><p>从流程图中可以看出，目前手续费分配的逻辑还是比较中心化的，需要平台管理员EOA账户和平台手续费收益管理员EOA账户来控制。</p><ul><li>平台管理员EOA账户主要负责提取手续费到平台手续费收益管理员EOA账户。</li><li>平台手续费收益管理员EOA账户主要负责把收到的手续费都换成WETH，并把WETH都转移到RewardDistributor合约。</li></ul><p><strong>相关合约地址</strong></p><table><thead><tr><th>合约名称</th><th>合约地址</th></tr></thead><tbody><tr><td>Timelock合约</td><td><a href=https://arbiscan.io/address/0xe7e740fa40ca16b15b621b49de8e9f0d69cf4858>0xe7e740fa40ca16b15b621b49de8e9f0d69cf4858</a></td></tr><tr><td>Vault合约</td><td><a href=https://arbiscan.io/address/0x489ee077994b6658eafa855c308275ead8097c4a>0x489ee077994b6658eafa855c308275ead8097c4a</a></td></tr><tr><td>Router合约</td><td><a href=https://arbiscan.io/address/0xabbc5f99639c9b6bcb58544ddf04efa6802f4064>0xabbc5f99639c9b6bcb58544ddf04efa6802f4064</a></td></tr><tr><td>sbfGMX RewardDistributor合约</td><td><a href=https://arbiscan.io/address/0x1de098faf30bd74f22753c28db17a2560d4f5554>0x1de098faf30bd74f22753c28db17a2560d4f5554</a></td></tr><tr><td>fGLP RewardDistributor合约</td><td><a href=https://arbiscan.io/address/0x5c04a12eb54a093c396f61355c6da0b15890150d>0x5c04a12eb54a093c396f61355c6da0b15890150d</a></td></tr></tbody></table><p><strong>相关交易操作交易Hash</strong></p><table><thead><tr><th>操作名称</th><th>交易Hash</th></tr></thead><tbody><tr><td>平台管理员提取手续费收益</td><td><a href=https://arbiscan.io/tx/0x8c0c1ceae993b037d003a195a72147a702f772986de3b4076cf614edaf6834d0>0x8c0c1ceae993b037d003a195a72147a702f772986de3b4076cf614edaf6834d0</a></td></tr><tr><td>手续费管理员执行Token Swap</td><td><a href=https://arbiscan.io/tx/0x2612bce63d085248fee6193b0ca3ba189d353bc7d3f5492017c7a6c7d933cbfd>0x2612bce63d085248fee6193b0ca3ba189d353bc7d3f5492017c7a6c7d933cbfd</a></td></tr><tr><td>手续费管理员执行Token Swap</td><td><a href=https://arbiscan.io/tx/0x4b1a039541b367d3fe38db73d491d58b9d9dd5baf7e34cd9bdd5286725634536>0x4b1a039541b367d3fe38db73d491d58b9d9dd5baf7e34cd9bdd5286725634536</a></td></tr><tr><td>手续费管理员执行Token Swap</td><td><a href=https://arbiscan.io/tx/0x8c46063bde7e5f415e0c0c72974c22ca28814f284f268f4565a071734d13bc8b>0x8c46063bde7e5f415e0c0c72974c22ca28814f284f268f4565a071734d13bc8b</a></td></tr><tr><td>手续费管理员执行Token Swap</td><td><a href=https://arbiscan.io/tx/0x0ea7999ad2cb34bbd88e88be66bb5f7758b4f33283d1d20bc82f7e4b507afdf3>0x0ea7999ad2cb34bbd88e88be66bb5f7758b4f33283d1d20bc82f7e4b507afdf3</a></td></tr><tr><td>手续费管理员执行Token Swap</td><td><a href=https://arbiscan.io/tx/0x40cfbc735a065d63f9058cbde762dc1ca7fe7e39308b7b216e285d62a246c206>0x40cfbc735a065d63f9058cbde762dc1ca7fe7e39308b7b216e285d62a246c206</a></td></tr><tr><td>手续费管理员执行Token Swap</td><td><a href=https://arbiscan.io/tx/0x0d39b2273b70f677543a6f204810dd3e16abc0adb09804a721b4502b68b2c8b2>0x0d39b2273b70f677543a6f204810dd3e16abc0adb09804a721b4502b68b2c8b2</a></td></tr><tr><td>手续费管理员把WETH转移到sbfGMX RewardDistributor合约</td><td><a href=https://arbiscan.io/tx/0xe77d0ef63db5a776b976dc13f46d5942b7a11ccad953e20f3c7b7ae88f888679>0xe77d0ef63db5a776b976dc13f46d5942b7a11ccad953e20f3c7b7ae88f888679</a></td></tr><tr><td>手续费管理员把WETH转移到fGLP RewardDistributor合约</td><td><a href=https://arbiscan.io/tx/0x71e030541f1e10cd866ab15fa7eb3c0645ddeccce5c782baa7eb05f8d2490613>0x71e030541f1e10cd866ab15fa7eb3c0645ddeccce5c782baa7eb05f8d2490613</a></td></tr></tbody></table><h1 id=5-总结>5 总结<a hidden class=anchor aria-hidden=true href=#5-总结>#</a></h1><p>总体来看，除了平台手续费分配这块还比较中心化，其它部分都是由智能合约自动完成。因此，可以说整个项目还是比较去中心化。随着中心交易所FTX暴雷，未来使用去中心化交易所可以说是大势所趋，去中心化合约交易所更是兵家必争之地。GMX作为去中心合约交易的龙头，它的优势也是非常明显：</p><ol><li><strong>去中心化</strong>。GMX是一个去中心化的永续合约交易平台，所有资产由智能合约保管，智能合约开源，所有运营数据也是公开透明的。</li><li><strong>全额保证金</strong>。GMX上面的所有杠杆订单都是有全额保证金的，保障用户的收益能够钢性对付，很多中心化交易所都无法做到全额保证金。</li><li><strong>市场报价去中心化</strong>。系统报价主要由ChainLink和报价机器人组成，报价公开透明，有效避免了恶意插针等扰乱市场的行为。
它的劣势也非常明显：</li><li><strong>币种太少</strong>。包括4种主流代币、4种稳定币，不能满足大部分用户的需求。</li><li><strong>无法做到Permissionless</strong>。由于GMX的架构设计，无法像Uniswap那样自由添加代币，它只能预先设定好支持哪些代币，无法自由扩展代币种类。
但不可否认的是，GMX所在的赛道发展潜力巨大，未来一定会诞生超级巨头。虽然GMX目前是去中心化永续合约交易所的龙头，但是还需要升级改造，解决目前平台目前的问题，让用户能像使用中心化永续合约交易所一样去使用去中心化的永续合约交易所。</li></ol></div><footer class=post-footer><ul class=post-tags></ul><nav class=paginav><a class=next href=https://zhongxuqi.github.io/web3/2023-02-07/><span class=title>Next »</span><br><span>解读闪电网络Lightning Network原理</span></a></nav><div class=share-buttons><a target=_blank rel="noopener noreferrer" aria-label="share 深度解读GMX：去中心化永续合约交易所 on twitter" href="https://twitter.com/intent/tweet/?text=%e6%b7%b1%e5%ba%a6%e8%a7%a3%e8%af%bbGMX%ef%bc%9a%e5%8e%bb%e4%b8%ad%e5%bf%83%e5%8c%96%e6%b0%b8%e7%bb%ad%e5%90%88%e7%ba%a6%e4%ba%a4%e6%98%93%e6%89%80&url=https%3a%2f%2fzhongxuqi.github.io%2fweb3%2f2023-02-27%2f&hashtags="><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM195.519 424.544c135.939.0 210.268-112.643 210.268-210.268.0-3.218.0-6.437-.153-9.502 14.406-10.421 26.973-23.448 36.935-38.314-13.18 5.824-27.433 9.809-42.452 11.648 15.326-9.196 26.973-23.602 32.49-40.92-14.252 8.429-30.038 14.56-46.896 17.931-13.487-14.406-32.644-23.295-53.946-23.295-40.767.0-73.87 33.104-73.87 73.87.0 5.824.613 11.494 1.992 16.858-61.456-3.065-115.862-32.49-152.337-77.241-6.284 10.881-9.962 23.601-9.962 37.088.0 25.594 13.027 48.276 32.95 61.456-12.107-.307-23.448-3.678-33.41-9.196v.92c0 35.862 25.441 65.594 59.311 72.49-6.13 1.686-12.72 2.606-19.464 2.606-4.751.0-9.348-.46-13.946-1.38 9.349 29.426 36.628 50.728 68.965 51.341-25.287 19.771-57.164 31.571-91.8 31.571-5.977.0-11.801-.306-17.625-1.073 32.337 21.15 71.264 33.41 112.95 33.41z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share 深度解读GMX：去中心化永续合约交易所 on linkedin" href="https://www.linkedin.com/shareArticle?mini=true&url=https%3a%2f%2fzhongxuqi.github.io%2fweb3%2f2023-02-27%2f&title=%e6%b7%b1%e5%ba%a6%e8%a7%a3%e8%af%bbGMX%ef%bc%9a%e5%8e%bb%e4%b8%ad%e5%bf%83%e5%8c%96%e6%b0%b8%e7%bb%ad%e5%90%88%e7%ba%a6%e4%ba%a4%e6%98%93%e6%89%80&summary=%e6%b7%b1%e5%ba%a6%e8%a7%a3%e8%af%bbGMX%ef%bc%9a%e5%8e%bb%e4%b8%ad%e5%bf%83%e5%8c%96%e6%b0%b8%e7%bb%ad%e5%90%88%e7%ba%a6%e4%ba%a4%e6%98%93%e6%89%80&source=https%3a%2f%2fzhongxuqi.github.io%2fweb3%2f2023-02-27%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM160.461 423.278V197.561h-75.04v225.717h75.04zm270.539.0V293.839c0-69.333-37.018-101.586-86.381-101.586-39.804.0-57.634 21.891-67.617 37.266v-31.958h-75.021c.995 21.181.0 225.717.0 225.717h75.02V297.222c0-6.748.486-13.492 2.474-18.315 5.414-13.475 17.767-27.434 38.494-27.434 27.135.0 38.007 20.707 38.007 51.037v120.768H431zM123.448 88.722C97.774 88.722 81 105.601 81 127.724c0 21.658 16.264 39.002 41.455 39.002h.484c26.165.0 42.452-17.344 42.452-39.002-.485-22.092-16.241-38.954-41.943-39.002z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share 深度解读GMX：去中心化永续合约交易所 on reddit" href="https://reddit.com/submit?url=https%3a%2f%2fzhongxuqi.github.io%2fweb3%2f2023-02-27%2f&title=%e6%b7%b1%e5%ba%a6%e8%a7%a3%e8%af%bbGMX%ef%bc%9a%e5%8e%bb%e4%b8%ad%e5%bf%83%e5%8c%96%e6%b0%b8%e7%bb%ad%e5%90%88%e7%ba%a6%e4%ba%a4%e6%98%93%e6%89%80"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM446 265.638c0-22.964-18.616-41.58-41.58-41.58-11.211.0-21.361 4.457-28.841 11.666-28.424-20.508-67.586-33.757-111.204-35.278l18.941-89.121 61.884 13.157c.756 15.734 13.642 28.29 29.56 28.29 16.407.0 29.706-13.299 29.706-29.701.0-16.403-13.299-29.702-29.706-29.702-11.666.0-21.657 6.792-26.515 16.578l-69.105-14.69c-1.922-.418-3.939-.042-5.585 1.036-1.658 1.073-2.811 2.761-3.224 4.686l-21.152 99.438c-44.258 1.228-84.046 14.494-112.837 35.232-7.468-7.164-17.589-11.591-28.757-11.591-22.965.0-41.585 18.616-41.585 41.58.0 16.896 10.095 31.41 24.568 37.918-.639 4.135-.99 8.328-.99 12.576.0 63.977 74.469 115.836 166.33 115.836s166.334-51.859 166.334-115.836c0-4.218-.347-8.387-.977-12.493 14.564-6.47 24.735-21.034 24.735-38.001zM326.526 373.831c-20.27 20.241-59.115 21.816-70.534 21.816-11.428.0-50.277-1.575-70.522-21.82-3.007-3.008-3.007-7.882.0-10.889 3.003-2.999 7.882-3.003 10.885.0 12.777 12.781 40.11 17.317 59.637 17.317 19.522.0 46.86-4.536 59.657-17.321 3.016-2.999 7.886-2.995 10.885.008 3.008 3.011 3.003 7.882-.008 10.889zm-5.23-48.781c-16.373.0-29.701-13.324-29.701-29.698.0-16.381 13.328-29.714 29.701-29.714 16.378.0 29.706 13.333 29.706 29.714.0 16.374-13.328 29.698-29.706 29.698zM160.91 295.348c0-16.381 13.328-29.71 29.714-29.71 16.369.0 29.689 13.329 29.689 29.71.0 16.373-13.32 29.693-29.689 29.693-16.386.0-29.714-13.32-29.714-29.693z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share 深度解读GMX：去中心化永续合约交易所 on facebook" href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2fzhongxuqi.github.io%2fweb3%2f2023-02-27%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H342.978V319.085h66.6l12.672-82.621h-79.272v-53.617c0-22.603 11.073-44.636 46.58-44.636H425.6v-70.34s-32.71-5.582-63.982-5.582c-65.288.0-107.96 39.569-107.96 111.204v62.971h-72.573v82.621h72.573V512h-191.104c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share 深度解读GMX：去中心化永续合约交易所 on whatsapp" href="https://api.whatsapp.com/send?text=%e6%b7%b1%e5%ba%a6%e8%a7%a3%e8%af%bbGMX%ef%bc%9a%e5%8e%bb%e4%b8%ad%e5%bf%83%e5%8c%96%e6%b0%b8%e7%bb%ad%e5%90%88%e7%ba%a6%e4%ba%a4%e6%98%93%e6%89%80%20-%20https%3a%2f%2fzhongxuqi.github.io%2fweb3%2f2023-02-27%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zm-58.673 127.703c-33.842-33.881-78.847-52.548-126.798-52.568-98.799.0-179.21 80.405-179.249 179.234-.013 31.593 8.241 62.428 23.927 89.612l-25.429 92.884 95.021-24.925c26.181 14.28 55.659 21.807 85.658 21.816h.074c98.789.0 179.206-80.413 179.247-179.243.018-47.895-18.61-92.93-52.451-126.81zM263.976 403.485h-.06c-26.734-.01-52.954-7.193-75.828-20.767l-5.441-3.229-56.386 14.792 15.05-54.977-3.542-5.637c-14.913-23.72-22.791-51.136-22.779-79.287.033-82.142 66.867-148.971 149.046-148.971 39.793.014 77.199 15.531 105.329 43.692 28.128 28.16 43.609 65.592 43.594 105.4-.034 82.149-66.866 148.983-148.983 148.984zm81.721-111.581c-4.479-2.242-26.499-13.075-30.604-14.571-4.105-1.495-7.091-2.241-10.077 2.241-2.986 4.483-11.569 14.572-14.182 17.562-2.612 2.988-5.225 3.364-9.703 1.12-4.479-2.241-18.91-6.97-36.017-22.23C231.8 264.15 222.81 249.484 220.198 245s-.279-6.908 1.963-9.14c2.016-2.007 4.48-5.232 6.719-7.847 2.24-2.615 2.986-4.484 4.479-7.472 1.493-2.99.747-5.604-.374-7.846-1.119-2.241-10.077-24.288-13.809-33.256-3.635-8.733-7.327-7.55-10.077-7.688-2.609-.13-5.598-.158-8.583-.158-2.986.0-7.839 1.121-11.944 5.604-4.105 4.484-15.675 15.32-15.675 37.364.0 22.046 16.048 43.342 18.287 46.332 2.24 2.99 31.582 48.227 76.511 67.627 10.685 4.615 19.028 7.371 25.533 9.434 10.728 3.41 20.492 2.929 28.209 1.775 8.605-1.285 26.499-10.833 30.231-21.295 3.732-10.464 3.732-19.431 2.612-21.298-1.119-1.869-4.105-2.99-8.583-5.232z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share 深度解读GMX：去中心化永续合约交易所 on telegram" href="https://telegram.me/share/url?text=%e6%b7%b1%e5%ba%a6%e8%a7%a3%e8%af%bbGMX%ef%bc%9a%e5%8e%bb%e4%b8%ad%e5%bf%83%e5%8c%96%e6%b0%b8%e7%bb%ad%e5%90%88%e7%ba%a6%e4%ba%a4%e6%98%93%e6%89%80&url=https%3a%2f%2fzhongxuqi.github.io%2fweb3%2f2023-02-27%2f"><svg viewBox="2 2 28 28" height="30" width="30" fill="currentcolor"><path d="M26.49 29.86H5.5a3.37 3.37.0 01-2.47-1 3.35 3.35.0 01-1-2.47V5.48A3.36 3.36.0 013 3 3.37 3.37.0 015.5 2h21A3.38 3.38.0 0129 3a3.36 3.36.0 011 2.46V26.37a3.35 3.35.0 01-1 2.47 3.38 3.38.0 01-2.51 1.02zm-5.38-6.71a.79.79.0 00.85-.66L24.73 9.24a.55.55.0 00-.18-.46.62.62.0 00-.41-.17q-.08.0-16.53 6.11a.59.59.0 00-.41.59.57.57.0 00.43.52l4 1.24 1.61 4.83a.62.62.0 00.63.43.56.56.0 00.4-.17L16.54 20l4.09 3A.9.9.0 0021.11 23.15zM13.8 20.71l-1.21-4q8.72-5.55 8.78-5.55c.15.0.23.0.23.16a.18.18.0 010 .06s-2.51 2.3-7.52 6.8z"/></svg></a></div></footer></article></main><footer class=footer><span>&copy; 2023 <a href=https://zhongxuqi.github.io/>Xuqi.Zhong的博客</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(t){t.preventDefault();var e=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(e)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(e)}']`).scrollIntoView({behavior:"smooth"}),e==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${e}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script></body></html>